<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campeonato de Solos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <!-- CSS embutido -->
    <style>
        /* Estilos gerais da p√°gina */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #1b1b1b;
            color: #ecf0f1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
        }

        h1 {
            text-align: center;
            color: #ecf0f1;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        table {
            max-width: 1000px;
            border-collapse: collapse;
            border-radius: 8px;
            overflow: hidden;
        }

        th,
        td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.425);
        }

        th {
            background-color: #00aaa29d;
            color: #161c22;
        }

        tr:nth-child(even) {
            background-color: #7f8c8d9d;
        }

        tr:nth-child(odd) {
            background-color: #95a5a6da;
        }

        td {
            color: #ecf0f1;
        }

        tr:hover {
            background-color: #05312f;
        }

        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: #1cceaa;
            color: #2c3e50;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .back-button:hover {
            background-color: #00cec9;
        }

        /* Layout Flexbox para as tabelas */
        .container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }

        .flex-column {
            display: flex;
            flex-direction: column;
        }

        #nav-buttons {
            text-align: center;
        }

        #nav-buttons button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #1cceaa;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        #nav-buttons button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }

        #nav-buttons button:hover:not(:disabled) {
            background-color: #00cec9;
        }

        /* Bot√µes no canto superior direito */
        .popup-button-container {
            top: 20px;
            right: 20px;
            flex-direction: column;
            position: fixed;

        }

        .popup-button {
            background-color: #1cceaa;
            color: #000000;
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .popup-button:hover {
            background-color: #00cec9;
        }

        /* Estilo do pop-up */
        #popup {
            font-size: 18px;
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }

        #popup-content {
            background-color: #272727;
            color: #ecf0f1;
            border-radius: 8px;
            padding: 20px;
            max-width: 800px;
            margin: 50px auto;
            position: relative;
        }

        #popup-content h2 {
            text-align: center;
        }

        .popup-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #e74c3c;
            color: #ecf0f1;
            border: none;
            border-radius: 5px;
            padding: 10px;
            cursor: pointer;
        }

        .popup-close:hover {
            background-color: #c0392b;
        }
    </style>
</head>

<body>
    <button class="back-button" onclick="window.history.back();">Voltar</button>
    <h2><span>üë§ü•á</span>Campeonato Solo #2 - Temporada</h2>
    <div class="container">

        <table id="classificacao-table">
            <caption
                style="font-size: 25px; color: rgb(255, 255, 255); background-color: rgb(0, 0, 0); border: 10px solid rgb(39, 39, 39); padding: 15px;">
                Classifica√ß√£o Geral
            </caption>
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Jogador</th>
                    <th>Kills</th>
                    <th>Partidas Disputadas</th>
                    <th>Total Pontua√ß√£o</th>
                </tr>
                <!-- Bot√µes no canto superior direito -->
                <div class="popup-button-container">
                    <button class="popup-button" onclick="openPopup('participar')">Como Participar</button><br><br>
                    <button class="popup-button" onclick="openPopup('regras')">Regras do Campeonato</button><br><br>
                    <button class="popup-button" onclick="openPopup('premiacao')">Valor da Premia√ß√£o</button><br><br>
                </div>

                <!-- Pop-up -->
                <div id="popup">
                    <div id="popup-content">
                        <button class="popup-close" onclick="closePopup()">X</button>
                        <h2 id="popup-title">T√≠tulo</h2>
                        <div id="popup-body">Conte√∫do</div>
                    </div>
                </div>
            </thead>
            <tbody id="classificacao-body"></tbody>
        </table>

        <div class="flex-column">
            <table id="tables">
                <tbody id="tables-body"></tbody>
                <thead></thead>
            </table>
            <div id="nav-buttons" style="margin-top: 10px; text-align: center;">
                <br>
                <button id="prev-btn" onclick="navigateTable(-1)" disabled>‚Üê</button>
                <button id="next-btn" onclick="navigateTable(1)"> ‚Üí</button>
            </div>
        </div>

        <table id="top5-table">
            <caption
                style="font-size: 25px; color: rgb(255, 255, 255); background-color: rgb(0, 0, 0); border: 10px solid rgb(39, 39, 39); padding: 15px;">
                Top 5 Kills
            </caption>
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Jogador</th>
                    <th>Kills</th>
                </tr>
            </thead>
            <tbody id="top5-body"></tbody>
        </table>
    </div>

    <script>

        const arquivosCSV = [
            "partida-10-Miramar.csv",
            "partida-9-Taego.csv",
            "partida-8-Paramo.csv",
            "partida-7-Vikendi.csv",
            "partida-6-Taego.csv",
            "partida-5-Miramar.csv",
            "partida-4-Deston.csv",
            "partida-3-Sanhok.csv",
            "partida-2-Karakin.csv",
            "partida-1-Erangel.csv"
        ];

        const tablesContainer = document.getElementById('tables-body');
        const classificacaoBody = document.getElementById('classificacao-body');
        const top5Body = document.getElementById('top5-body');
        let jogadores = {}; // Armazena informa√ß√µes de jogadores
        let tables = [];
        let currentTableIndex = 0;
        let hasValidData = false;

        // Carregando todos os arquivos CSV a partir da ordem mais recente
        const csvPromises = arquivosCSV.map((arquivoNome, index) => {
            return fetch('csv/' + arquivoNome + '?timestamp=' + new Date().getTime())
                .then(response => {
                    if (!response.ok) {
                        return Promise.reject('Arquivo n√£o encontrado: ' + arquivoNome);
                    }
                    return response.text();
                })
                .then(csvData => {
                    return new Promise((resolve, reject) => {
                        Papa.parse(csvData, {
                            header: true,
                            skipEmptyLines: true,
                            complete: function (results) {
                                if (results.data.length === 0) {
                                    return resolve(); // Ignora se n√£o houver dados v√°lidos
                                }

                                hasValidData = true;

                                // Processando dados de cada partida
                                results.data.forEach((rowData) => {
                                    const jogador = rowData['Jogador'];
                                    const kills = parseInt(rowData['Kills'], 10) || 0;
                                    const pontos = parseInt(rowData['Pontos'], 10) || 0;

                                    // Inicializa o jogador caso n√£o exista
                                    if (!jogadores[jogador]) {
                                        jogadores[jogador] = {
                                            kills: 0,
                                            pontos: 0,
                                            partidas: 0
                                        };
                                    }

                                    // Acumula kills e pontos
                                    jogadores[jogador].kills += kills;
                                    jogadores[jogador].pontos += pontos;
                                    jogadores[jogador].partidas += 1; // Conta as partidas disputadas
                                });

                                // Gerar a tabela de cada partida
                                const tableElement = generateTable(results.data, arquivoNome, index + 1);
                                tables.push(tableElement);
                                tablesContainer.appendChild(tableElement);

                                if (index === 0) {
                                    tableElement.style.display = 'block';
                                } else {
                                    tableElement.style.display = 'none';
                                }

                                resolve();
                            },
                            error: function (error) {
                                reject(error);
                            }
                        });
                    });
                })
                .catch(err => console.error('Erro ao carregar o CSV:', err));
        });

        // Espera todos os CSVs serem carregados antes de atualizar a classifica√ß√£o
        Promise.all(csvPromises).then(() => {
            if (hasValidData) {
                updateClassificacao(jogadores);
                updateTop5(jogadores);
            } else {
                document.getElementById('classificacao-table').style.display = 'none';
                document.getElementById('top5-table').style.display = 'none';
            }
        }).catch(err => console.error('Erro ao carregar algum dos CSVs:', err));

        // Fun√ß√£o para navegar entre as partidas
        function navigateTable(direction) {
            if (tables[currentTableIndex]) {
                tables[currentTableIndex].style.display = 'none';
            }

            currentTableIndex = Math.max(0, Math.min(currentTableIndex + direction, tables.length - 1));
            tables[currentTableIndex].style.display = 'block';

            document.getElementById('prev-btn').disabled = currentTableIndex === 0;
            document.getElementById('next-btn').disabled = currentTableIndex === tables.length - 1;
        }

        // Atualiza a tabela de classifica√ß√£o geral
        function updateClassificacao(jogadores) {
            const classificacaoOrdenada = Object.keys(jogadores)
                .map(jogador => ({
                    jogador,
                    kills: jogadores[jogador].kills,
                    pontos: jogadores[jogador].pontos,
                    partidas: jogadores[jogador].partidas
                }))
                .sort((a, b) => {
                    if (b.pontos === a.pontos) {
                        return b.partidas - a.partidas;
                    }
                    return b.pontos - a.pontos;
                });

            classificacaoBody.innerHTML = '';
            classificacaoOrdenada.forEach((item, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML =
                    `<td>${index + 1}</td>
            <td>${item.jogador}</td>
            <td>${item.kills}</td>
            <td>${item.partidas}</td>
            <td>${item.pontos}</td>`;
                classificacaoBody.appendChild(tr);
            });
        }

        // Atualiza a tabela do Top 5 de Kills
        function updateTop5(jogadores) {
            const top5Ordenado = Object.keys(jogadores)
                .map(jogador => ({
                    jogador,
                    kills: jogadores[jogador].kills
                }))
                .sort((a, b) => b.kills - a.kills)
                .slice(0, 5);

            top5Body.innerHTML = '';
            top5Ordenado.forEach((item, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML =
                    `<td>${index + 1}</td>
            <td>${item.jogador}</td>
            <td>${item.kills}</td>`;
                top5Body.appendChild(tr);
            });
        }

        // Gera a tabela de uma partida
        function generateTable(data, arquivoNome, numeroPartida) {
            const table = document.createElement('table');

            // Remover a extens√£o '.csv' do nome do arquivo
            const nomeSemExtensao = arquivoNome.replace('.csv', '');  // Remove a extens√£o '.csv'

            // Dividir o nome do arquivo sem a extens√£o para extrair o n√∫mero da partida e o mapa
            const partes = nomeSemExtensao.split('-'); // Ex: "partida-2-Karakin"
            const partida = partes[1]; // "2"
            const mapa = partes[2]; // "Karakin"

            const caption = document.createElement('caption');
            caption.textContent = `Partida #${partida} - ${mapa}`;  // Exibir sem a extens√£o
            table.appendChild(caption);

            const thead = document.createElement('thead');
            thead.innerHTML =
                `<tr>
        <th>Posi√ß√£o</th>
        <th>Jogador</th>
        <th>Kills</th>
        <th>Pontos</th>
    </tr>`;
            table.appendChild(thead);

            const tbody = document.createElement('tbody');
            data.forEach((rowData) => {
                const tr = document.createElement('tr');
                tr.innerHTML =
                    `<td>${rowData['Posi√ß√£o']}</td>
        <td>${rowData['Jogador']}</td>
        <td>${rowData['Kills']}</td>
        <td>${rowData['Pontos']}</td>`;
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);

            return table;
        }

        window.onload = function () {
            // Chama a fun√ß√£o 'navigateTable(1)' para avan√ßar para a pr√≥xima tabela
            setTimeout(function () {
                navigateTable(1);  // Chama a fun√ß√£o de pr√≥xima tabela
            }, 1000); // 1000 milissegundos = 1 segundo

            // Chama a fun√ß√£o 'navigateTable(-1)' para voltar para a tabela anterior ap√≥s 2 segundos
            setTimeout(function () {
                navigateTable(-1);  // Chama a fun√ß√£o de tabela anterior
            }, 2000); // 2000 milissegundos = 2 segundos
        };
        // Fun√ß√£o para abrir o pop-up
        function openPopup(tipo) {
            document.getElementById('popup').style.display = 'block'; // Exibe o pop-up
            const title = document.getElementById('popup-title');
            const body = document.getElementById('popup-body');

            // Define o conte√∫do do pop-up com base no tipo
            if (tipo === 'participar') {
                title.textContent = 'Como Participar';
                body.innerHTML = '<p>Para participar do campeonato de solos, basta estar no cl√£ com a insignia [VIN] no nome e fazer parte do grupo no WhatsApp. As partidas acontecem diariamente, √†s 19:30h, com dois confrontos consecutivos por dia, iniciando na segunda-feira, 18/11, e indo at√© a sexta-feira, 22/11, quando ser√° realizada a final.</p>';
            } else if (tipo === 'regras') {
                title.textContent = 'Regras do Campeonato';
                body.innerHTML = '<p>Qualquer jogador pode entrar em qualquer dia de jogo, mas √© importante seguir as regras:</p>' +
                    '<ul>' +
                        '<li>Apenas jogadores do cl√£ [VIN] s√£o permitidos participar do campeonato.</li>' +
                    '<li>Uso de cheats ou qualquer outra abordagem que viole as regras ser√° banido imediatamente.</li>' +
                    '<li>Comportamento anti√©tico ou inadequado durante as partidas resultar√° em desqualifica√ß√£o.</li>' +
                    '</ul>' +
                    '<h3>Programa√ß√£o da Semana</h3>' +
                    '<p><strong>Pontos Corridos - Nova Fase!</strong></p>' +
                    '<p><strong>In√≠cio:</strong> Amanh√£, 18/11, √†s 19:30h!</p>' +

                    '<h4>Segunda-feira:</h4>' +
                    '<ul>' +
                    '<li><strong>Jogo 1:</strong> 19:30 (Mapa: Erangel)</li>' +
                    '<li><strong>Jogo 2:</strong> Ap√≥s o primeiro jogo (Mapa: Karakin)</li>' +
                    '</ul>' +

                    '<h4>Ter√ßa-feira:</h4>' +
                    '<ul>' +
                    '<li><strong>Jogo 3:</strong> 19:30 (Mapa: Sanhok)</li>' +
                    '<li><strong>Jogo 4:</strong> Ap√≥s o primeiro jogo (Mapa: Deston)</li>' +
                    '</ul>' +

                    '<h4>Quarta-feira:</h4>' +
                    '<ul>' +
                    '<li><strong>Jogo 5:</strong> 19:30 (Mapa: Miramar)</li>' +
                    '<li><strong>Jogo 6:</strong> Ap√≥s o primeiro jogo (Mapa: Taego)</li>' +
                    '</ul>' +

                    '<h4>Quinta-feira:</h4>' +
                    '<ul>' +
                    '<li><strong>Jogo 7:</strong> 19:30 (Mapa: Vikendi)</li>' +
                    '<li><strong>Jogo 8:</strong> Ap√≥s o primeiro jogo (Mapa: Paramo)</li>' +
                    '</ul>' +

                    '<h4>Sexta-feira:</h4>' +
                    '<ul>' +
                    '<li><strong>Jogo 9:</strong> 19:30 (Mapa: Taego)</li>' +
                    '<li><strong>Jogo 10:</strong> Ap√≥s o primeiro jogo (Mapa: Miramar)</li>' +
                    '</ul>' +

                    '<h3>OBSERVA√á√ïES:</h3>' +
                    '<ul>' +
                    '<li>Todos os jogos come√ßam √†s 19:30, com o segundo jogo acontecendo logo ap√≥s o primeiro.</li>' +
                    '<li>A programa√ß√£o √© v√°lida de segunda a sexta-feira, com s√°bado e domingo livres para prepara√ß√£o para a pr√≥xima semana, que ser√° o campeonato de duos.</li>' +
                    '</ul>';
            } else if (tipo === 'premiacao') {
                title.textContent = 'Valor da Premia√ß√£o';
                body.innerHTML = '<p>O vencedor do campeonato receber√° a premia√ß√£o de acordo com o valor arrecadado, que atualmente √© de R$00,00.</p><p>Para contribuir com o fundo de premia√ß√£o, utilize o PIX:</p>' +'<p><strong>Chave PIX:</strong> 54992767447</p>';
            }
        }

        // Fun√ß√£o para fechar o pop-up
        function closePopup() {
            document.getElementById('popup').style.display = 'none'; // Esconde o pop-up
        }


        // Fun√ß√£o para fechar o pop-up
        function closePopup() {
            document.getElementById('popup').style.display = 'none';
        }


    </script>
</body>

</html>